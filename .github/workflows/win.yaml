name: Ubuntu 25.3.1 alpha

on:
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    timeout-minutes: 360

    steps:
    - name: Update system
      run: |
        sudo apt update -y
        sudo apt upgrade -y

    - name: Create user blender
      run: |
        sudo useradd -m -s /bin/bash blender
        echo "blender:123456Hi" | sudo chpasswd
        sudo usermod -aG sudo blender
        echo "✅ User blender created with sudo privileges"

    - name: Install XFCE4 Desktop + RDP + SSH
      run: |
        sudo apt install -y xfce4 xrdp openssh-server
        sudo systemctl enable xrdp
        sudo systemctl start xrdp
        sudo systemctl enable ssh
        sudo systemctl start ssh
        echo "✅ XFCE + RDP + SSH installed & running"

    - name: Start Pinggy tunnel for RDP
      run: |
        ssh -o StrictHostKeyChecking=no -p 443 -R0:127.0.0.1:3389 qr@free.pinggy.io &
        sleep 15
        echo "==========================="
        echo "    🐧 DUO VPS - Ubuntu RDP "
        echo " BY: 🐉 SHANGHAI & NULLTESTFUN1 ⚡"
        echo "==========================="
        echo " 🌐 HOST/IP : (xem log Pinggy ở trên)"
        echo " 👤 USER    : blender"
        echo " 🔑 PASS    : 123456Hi"
        echo " ⏱️ Max TIME: 6 Hour"
        echo "==========================="

    - name: Start Pinggy tunnel for SSH
      run: |
        ssh -o StrictHostKeyChecking=no -p 443 -R0:127.0.0.1:22 qr@free.pinggy.io &
        sleep 5
        echo "✅ SSH tunnel started"
        echo "➡ Login bằng: ssh blender@HOST -p PORT (xem log Pinggy)"
    
    - name: Keep Alive
      run: |
        while true; do
          echo "🔹 Alive ping at $(date +%H:%M:%S) :: $RANDOM"
          sleep 300
        done
